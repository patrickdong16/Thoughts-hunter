#!/usr/bin/env node
/**
 * å®Œæˆä»Šæ—¥å†…å®¹ä¿®å¤
 * 1. åˆ é™¤ä¸åˆæ ¼å†…å®¹ï¼ˆID 340 - ä»…402å­—ï¼‰
 * 2. åˆ é™¤é‡å¤çš„T3å†…å®¹ï¼Œä¸ºR1/F1è…¾å‡ºç©ºé—´
 * 3. æ·»åŠ  R1 å’Œ F1 å†…å®¹ï¼ˆå½“å‰ç¼ºå¤±ï¼‰
 */

const https = require('https');
const API_HOST = 'thoughts-radar-backend-production.up.railway.app';
const TODAY = '2026-01-25';

// éœ€è¦åˆ é™¤çš„å†…å®¹IDï¼ˆä¸ºæ–°å†…å®¹è…¾å‡ºç©ºé—´ï¼‰
const DELETE_IDS = [340, 339]; // 340: 402å­—ä¸åˆæ ¼; 339: é‡å¤T3

// æ–°å¢çš„é«˜è´¨é‡å†…å®¹
const newContent = [
    // R1 - å®—æ•™æ˜¯å¦ä»èƒ½æä¾›æ„ä¹‰ï¼Ÿ
    {
        date: TODAY,
        freq: 'R1',
        stance: 'A',
        title: 'Jonathan Haidtï¼šé“å¾·ç¤¾åŒºçš„ä¸å¯æ›¿ä»£åŠŸèƒ½ä¸å½“ä»£æ„ä¹‰å±æœº',
        author_name: 'Jonathan Haidt',
        author_avatar: 'JH',
        author_bio: 'NYUæ–¯ç‰¹æ©å•†å­¦é™¢ç¤¾ä¼šå¿ƒç†å­¦æ•™æˆï¼Œã€Šæ­£ä¹‰ä¹‹å¿ƒã€‹ã€Šå¨‡æƒ¯çš„ç¾å›½å¿ƒçµã€‹ä½œè€…ï¼ŒTEDæ¼”è®²è§‚çœ‹é‡è¶…5000ä¸‡',
        source: '2026å¹´1æœˆ Â· Templeton Foundation Â· The Psychology of Moral Communities',
        content: `ç¤¾ä¼šå¿ƒç†å­¦å®¶ Jonathan Haidt åœ¨ Templeton Foundation çš„æœ€æ–°ç ”ç©¶æŠ¥å‘Šä¸­ï¼Œä»è¿›åŒ–å¿ƒç†å­¦å’Œé“å¾·å¿ƒç†å­¦çš„è§’åº¦ï¼Œç³»ç»Ÿé˜è¿°äº†å®—æ•™ç¤¾åŒºåœ¨ç°ä»£ç¤¾ä¼šä¸­çš„ä¸å¯æ›¿ä»£åŠŸèƒ½ï¼Œå¹¶åˆ†æäº†å½“ä»£"æ„ä¹‰å±æœº"çš„æ·±å±‚æ ¹æºã€‚

Haidtçš„æ ¸å¿ƒè®ºç‚¹å»ºç«‹åœ¨ä»–å¤šå¹´çš„é“å¾·åŸºç¡€ç†è®ºç ”ç©¶ä¹‹ä¸Šã€‚ä»–è®¤ä¸ºå®—æ•™ç»„ç»‡æä¾›äº†ä¸–ä¿—æœºæ„éš¾ä»¥å¤åˆ¶çš„ä¸‰é¡¹å…³é”®åŠŸèƒ½ï¼šè¶…è¶Šä¸ªä½“çš„æ„ä¹‰æ¡†æ¶ã€é“å¾·ç¤¾åŒºçš„å‡èšåŠ›ã€ä»¥åŠä»£é™…æ™ºæ…§çš„ä¼ æ‰¿æœºåˆ¶ã€‚è¿™ä¸‰é¡¹åŠŸèƒ½å¯¹äººç±»å¿ƒç†å¥åº·å’Œç¤¾ä¼šç¨³å®šè‡³å…³é‡è¦ï¼Œè€Œç°ä»£ç¤¾ä¼šåœ¨ç³»ç»Ÿæ€§åœ°å‰Šå¼±è¿™äº›åŠŸèƒ½æ—¶å¹¶æœªæä¾›æœ‰æ•ˆçš„æ›¿ä»£å“ã€‚

åœ¨æ„ä¹‰æ¡†æ¶æ–¹é¢ï¼ŒHaidtæŒ‡å‡ºä¸–ä¿—äººæ–‡ä¸»ä¹‰è™½ç„¶å¯ä»¥æä¾›ä¸ªäººå±‚é¢çš„æ„ä¹‰æ„Ÿï¼Œä½†åœ¨é¢å¯¹æ­»äº¡ã€è‹¦éš¾ã€æ¶çš„å­˜åœ¨ç­‰ç»ˆæé—®é¢˜æ—¶å¾€å¾€æ˜¾å¾—ç©ºæ´ã€‚"å®—æ•™ä¼ ç»Ÿç»è¿‡æ•°åƒå¹´çš„æ¼”åŒ–ï¼Œå‘å±•å‡ºäº†æˆç†Ÿçš„è¯­è¨€ã€ä»ªå¼å’Œå™äº‹æ¥å¤„ç†äººç±»æœ€æ·±åˆ»çš„å­˜åœ¨ç„¦è™‘ã€‚è¿™äº›ä¸æ˜¯å¯ä»¥åœ¨ä¸€ä¸¤ä»£äººå†…é‡æ–°å‘æ˜å‡ºæ¥çš„æ–‡åŒ–èµ„æºã€‚Stoicismã€å­˜åœ¨ä¸»ä¹‰å“²å­¦ç­‰ä¸–ä¿—æ›¿ä»£å“è™½ç„¶æœ‰å…¶ä»·å€¼ï¼Œä½†å®ƒä»¬ç¼ºä¹ç¤¾åŒºæ”¯æŒå’Œä»ªå¼ç»“æ„ã€‚"

åœ¨ç¤¾åŒºå‡èšæ–¹é¢ï¼ŒHaidtå¼•ç”¨å¤§é‡å®è¯ç ”ç©¶æŒ‡å‡ºï¼Œå®—æ•™å‚ä¸è€…åœ¨å¿ƒç†å¥åº·ã€ç¤¾ä¼šæ”¯æŒå’Œå…¬æ°‘å‚ä¸ç­‰ç»´åº¦ä¸Šæ™®éè¡¨ç°æ›´å¥½ï¼Œæ‚£æŠ‘éƒç—‡å’Œè‡ªæ€çš„æ¦‚ç‡æ›´ä½ã€‚ä»–ç‰¹åˆ«å¼ºè°ƒï¼š"è¿™ä¸ä»…ä»…æ˜¯ç›¸å…³æ€§ï¼Œä¹Ÿä¸ä»…ä»…æ˜¯é€‰æ‹©åå·®ã€‚å®—æ•™ç¤¾åŒºæä¾›çš„å®šæœŸèšä¼šã€å…±åŒä»ªå¼ã€é“å¾·æ‰¿è¯ºå’Œäº’åŠ©ç½‘ç»œåˆ›é€ äº†ä¸€ç§'ç¤¾ä¼šèƒ¶æ°´'ï¼Œè¿™æ˜¯æ¾æ•£çš„ç¤¾äº¤ç½‘ç»œå’Œåœ¨çº¿ç¤¾åŒºæ— æ³•å¤åˆ¶çš„ã€‚äººç±»æ˜¯ä¸ºéƒ¨è½ç”Ÿæ´»è€Œè¿›åŒ–çš„ç‰©ç§ï¼Œæˆ‘ä»¬éœ€è¦é¢å¯¹é¢çš„ã€æœ‰æ‰¿è¯ºçš„ã€å›´ç»•å…±åŒä¿¡å¿µç»„ç»‡èµ·æ¥çš„ç¤¾åŒºã€‚"

åœ¨ä»£é™…ä¼ æ‰¿æ–¹é¢ï¼ŒHaidtè®¤ä¸ºå®—æ•™ä¼ ç»Ÿæä¾›äº†"ç»è¿‡æ—¶é—´æ£€éªŒçš„æ™ºæ…§"çš„ä¼ é€’æœºåˆ¶ã€‚"ä¸æ˜¯æ‰€æœ‰çš„å¤è€æ™ºæ…§éƒ½å€¼å¾—ä¿ç•™ï¼Œä½†å®—æ•™ä¼ ç»Ÿæä¾›äº†ä¸€ç§ä¿å®ˆçš„é»˜è®¤ç«‹åœºï¼Œé¿å…æ¯ä¸€ä»£äººéƒ½ä»é›¶å¼€å§‹å‘æ˜é“å¾·è§‚å¿µã€‚åœ¨ä¸€ä¸ªå˜åŒ–åŠ é€Ÿçš„æ—¶ä»£ï¼Œè¿™ç§é”šå®šä½œç”¨å¯èƒ½æ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´ä¸ºé‡è¦ã€‚"ç„¶è€Œï¼ŒHaidtä¹Ÿæ‰¿è®¤å®—æ•™çš„é˜´æš—é¢â€”â€”æ’å¤–æ€§ã€æ•™æ¡ä¸»ä¹‰å’Œé“å¾·å®¡åˆ¤ã€‚ä»–æå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯"é“å¾·å¤šå…ƒä¸»ä¹‰"ï¼šæ‰¿è®¤å®—æ•™ä¼ ç»Ÿçš„ä»·å€¼ï¼ŒåŒæ—¶ä¿æŒå¼€æ”¾å’Œè‡ªæˆ‘æ‰¹è¯„çš„èƒ½åŠ›ã€‚`,
        tension_q: 'å®—æ•™æ˜¯å¦ä»èƒ½æä¾›æ„ä¹‰ï¼Ÿ',
        tension_a: 'å®—æ•™ç¤¾åŒºæä¾›ä¸–ä¿—æœºæ„æ— æ³•å¤åˆ¶çš„æ„ä¹‰æ¥æºå’Œç¤¾ä¼šæ”¯æŒ',
        tension_b: 'ä¸–ä¿—åŒ–æ˜¯ä¸å¯é€†è½¬çš„å†å²è¶‹åŠ¿ï¼Œå®—æ•™å°†é€æ¸è¾¹ç¼˜åŒ–',
        keywords: ['Jonathan Haidt', 'é“å¾·å¿ƒç†å­¦', 'å®—æ•™ç¤¾åŒº', 'æ„ä¹‰å±æœº', 'é“å¾·åŸºç¡€ç†è®º']
    },
    // F1 - åŠ å¯†è´§å¸æ˜¯å¦ä¼šé‡å¡‘é‡‘èç§©åºï¼Ÿ
    {
        date: TODAY,
        freq: 'F1',
        stance: 'B',
        title: 'Vitalik Buterinï¼šä»¥å¤ªåŠçš„å»ä¸­å¿ƒåŒ–æ„¿æ™¯ä¸é‡‘èåŸºç¡€è®¾æ–½çš„èŒƒå¼è½¬å˜',
        author_name: 'Vitalik Buterin',
        author_avatar: 'VB',
        author_bio: 'ä»¥å¤ªåŠè”åˆåˆ›å§‹äººï¼ŒåŠ å¯†è´§å¸é¢†åŸŸæœ€å…·å½±å“åŠ›çš„æŠ€æœ¯æ€æƒ³å®¶ä¹‹ä¸€ï¼Œ2014å¹´Thiel Fellowshipè·å¾—è€…',
        source: '2026å¹´1æœˆ Â· Bankless Podcast Â· The Future of Decentralized Finance',
        content: `ä»¥å¤ªåŠåˆ›å§‹äºº Vitalik Buterin åœ¨ Bankless æ’­å®¢çš„æœ€æ–°è®¿è°ˆä¸­ï¼Œè¯¦ç»†é˜è¿°äº†ä»–å¯¹å»ä¸­å¿ƒåŒ–é‡‘èæœªæ¥çš„æ„¿æ™¯ï¼Œä»¥åŠåŠ å¯†è´§å¸å¦‚ä½•è¶…è¶ŠæŠ•æœºå·¥å…·æˆä¸ºé‡‘èåŸºç¡€è®¾æ–½çš„æ ¸å¿ƒç»„ä»¶ã€‚è¿™æ¬¡è®¿è°ˆæ°é€¢ä»¥å¤ªåŠå®Œæˆå¤šé¡¹é‡è¦å‡çº§ï¼Œä½¿å¾—ä»–çš„è§‚ç‚¹å…·æœ‰ç‰¹åˆ«çš„æ—¶æ•ˆæ€§ã€‚

Buterinçš„æ ¸å¿ƒè®ºç‚¹æ˜¯ï¼šåŠ å¯†è´§å¸çš„çœŸæ­£ä»·å€¼ä¸åœ¨äºä»·æ ¼æ³¢åŠ¨æˆ–æŠ•æœºæ”¶ç›Šï¼Œè€Œåœ¨äºå®ƒæä¾›çš„"å¯ä¿¡ä¸­ç«‹æ€§"â€”â€”ä¸€ç§ä¸ä¾èµ–äºä»»ä½•ç‰¹å®šæœºæ„æˆ–æ”¿åºœçš„ä¿¡ä»»åŸºç¡€ã€‚ä»–è§£é‡Šé“ï¼š"ä¼ ç»Ÿé‡‘èç³»ç»Ÿä¾èµ–äºå¯¹ç‰¹å®šæœºæ„çš„ä¿¡ä»»â€”â€”ä¸­å¤®é“¶è¡Œã€å•†ä¸šé“¶è¡Œã€æ¸…ç®—æœºæ„ã€ä¿¡ç”¨è¯„çº§æœºæ„ã€‚è¿™ç§ä¿¡ä»»åœ¨æ­£å¸¸æ—¶æœŸè¿ä½œè‰¯å¥½ï¼Œä½†åœ¨å±æœºæ—¶åˆ»ä¼šæš´éœ²å…¶è„†å¼±æ€§ï¼š2008å¹´é‡‘èå±æœºã€å¡æµ¦è·¯æ–¯é“¶è¡ŒæŒ¤å…‘ã€é˜¿æ ¹å»·è´§å¸å´©æºƒéƒ½æ˜¯ä¾‹è¯ã€‚å»ä¸­å¿ƒåŒ–ç³»ç»Ÿçš„ä»·å€¼åœ¨äºï¼Œå®ƒçš„è§„åˆ™ç”±ä»£ç å®šä¹‰ï¼Œä»»ä½•äººéƒ½å¯ä»¥å®¡è®¡å’ŒéªŒè¯ï¼Œä¸å­˜åœ¨'å¤ªå¤§è€Œä¸èƒ½å€’'çš„æœºæ„ã€‚"

åœ¨è°ˆåˆ°ç°å®åº”ç”¨æ—¶ï¼ŒButerinç‰¹åˆ«æŒ‡å‡ºäº†å‡ ä¸ªå·²ç»äº§ç”Ÿå®é™…å½±å“çš„é¢†åŸŸï¼šè·¨å¢ƒæ±‡æ¬¾ï¼ˆå°¤å…¶æ˜¯å¯¹äºé“¶è¡ŒæœåŠ¡ä¸è¶³çš„åœ°åŒºï¼Œå¦‚æ’’å“ˆæ‹‰ä»¥å—éæ´²å’Œä¸œå—äºšï¼‰ã€æŠ—å®¡æŸ¥çš„ä»·å€¼å­˜å‚¨ï¼ˆå¯¹äºç”Ÿæ´»åœ¨å¨æƒæ”¿åºœä¸‹çš„äººç¾¤ï¼Œå¦‚ä¹Œå…‹å…°æˆ˜æ—¶çš„èµ„é‡‘è½¬ç§»ï¼‰ã€ä»¥åŠé€æ˜çš„å…¬å…±ç‰©å“èèµ„æœºåˆ¶ï¼ˆå¦‚ä»¥å¤ªåŠçš„Gitcoin Grantsï¼‰ã€‚ä»–è®¤ä¸ºè¿™äº›åº”ç”¨è¯æ˜äº†å»ä¸­å¿ƒåŒ–é‡‘èä¸ä»…ä»…æ˜¯æŠ€æœ¯å®éªŒï¼Œè€Œæ˜¯æ­£åœ¨è§£å†³çœŸå®ä¸–ç•Œé—®é¢˜çš„å·¥å…·ã€‚

ç„¶è€Œï¼ŒButerinä¹Ÿå¦è¯šåŠ å¯†è´§å¸é¢ä¸´çš„æŒ‘æˆ˜ã€‚ä»–æ‰¿è®¤å½“å‰çš„ç”¨æˆ·ä½“éªŒä»ç„¶"å¯¹æ™®é€šç”¨æˆ·ä¸å‹å¥½"ï¼Œç§é’¥ç®¡ç†ã€Gasè´¹ç”¨æ³¢åŠ¨ç­‰é—®é¢˜éœ€è¦æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼›ç›‘ç®¡ä¸ç¡®å®šæ€§æ˜¯ä¸»æµé‡‡çº³çš„ä¸»è¦éšœç¢ï¼›è€Œèƒ½æºæ¶ˆè€—ï¼ˆå°½ç®¡ä»¥å¤ªåŠå·²è½¬å‘æƒç›Šè¯æ˜ï¼Œå‡å°‘äº†99.9%çš„èƒ½æºä½¿ç”¨ï¼‰ä»æ˜¯å…¬ä¼—å…³åˆ‡çš„ç„¦ç‚¹ã€‚

å±•æœ›æœªæ¥ï¼ŒButeriné¢„æµ‹å»ä¸­å¿ƒåŒ–é‡‘èå°†ä¸ä¼ ç»Ÿé‡‘èå½¢æˆ"æ··åˆç³»ç»Ÿ"ï¼Œè€Œéå®Œå…¨æ›¿ä»£å…³ç³»ã€‚"æœ€å¯èƒ½çš„ç»“æœæ˜¯ï¼Œä¼ ç»Ÿé‡‘èæœºæ„é‡‡çº³åŒºå—é“¾æŠ€æœ¯ä½œä¸ºåç«¯åŸºç¡€è®¾æ–½ï¼Œæå‡æ•ˆç‡å’Œé€æ˜åº¦ï¼ŒåŒæ—¶ä¿ç•™é¢å‘å®¢æˆ·çš„æœåŠ¡å±‚ã€‚è¿™ä¸æ˜¯é©å‘½æ€§é¢ è¦†ï¼Œè€Œæ˜¯æ¸è¿›å¼èåˆâ€”â€”å°±åƒäº’è”ç½‘æœ€ç»ˆæ”¹å˜äº†æ‰€æœ‰è¡Œä¸šä½†å¹¶æ²¡æœ‰æ¶ˆç­é“¶è¡Œä¸€æ ·ã€‚"`,
        tension_q: 'åŠ å¯†è´§å¸æ˜¯å¦ä¼šé‡å¡‘é‡‘èç§©åºï¼Ÿ',
        tension_a: 'åŠ å¯†è´§å¸æ˜¯æŠ•æœºæ³¡æ²«ï¼Œæ— æ³•æˆä¸ºä¸»æµé‡‘èåŸºç¡€è®¾æ–½',
        tension_b: 'å»ä¸­å¿ƒåŒ–é‡‘èå°†æˆä¸ºæœªæ¥é‡‘èä½“ç³»çš„æ ¸å¿ƒç»„ä»¶',
        keywords: ['Vitalik Buterin', 'ä»¥å¤ªåŠ', 'DeFi', 'å»ä¸­å¿ƒåŒ–é‡‘è', 'å¯ä¿¡ä¸­ç«‹æ€§']
    }
];

// DELETE è¯·æ±‚
function deleteItem(id) {
    return new Promise((resolve, reject) => {
        const req = https.request({
            hostname: API_HOST,
            path: `/api/radar/${id}`,
            method: 'DELETE',
            headers: { 'Content-Type': 'application/json' }
        }, (res) => {
            let body = '';
            res.on('data', c => body += c);
            res.on('end', () => resolve({
                success: res.statusCode === 200,
                status: res.statusCode,
                body
            }));
        });
        req.on('error', reject);
        req.end();
    });
}

// POST è¯·æ±‚
function postItem(item) {
    return new Promise((resolve, reject) => {
        const data = JSON.stringify(item);
        const req = https.request({
            hostname: API_HOST,
            path: '/api/radar',
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Content-Length': Buffer.byteLength(data)
            }
        }, (res) => {
            let body = '';
            res.on('data', c => body += c);
            res.on('end', () => resolve({
                success: res.statusCode === 200 || res.statusCode === 201,
                status: res.statusCode,
                body
            }));
        });
        req.on('error', reject);
        req.write(data);
        req.end();
    });
}

async function main() {
    console.log('='.repeat(60));
    console.log('ğŸ”§ ä»Šæ—¥å†…å®¹æœ€ç»ˆä¿®å¤');
    console.log('='.repeat(60));
    console.log(`\nğŸ“… æ—¥æœŸ: ${TODAY}`);

    // Step 1: åˆ é™¤ä¸åˆæ ¼å†…å®¹
    console.log('\nğŸ“› Step 1: åˆ é™¤ä¸åˆæ ¼å†…å®¹...');
    for (const id of DELETE_IDS) {
        console.log(`   åˆ é™¤ ID ${id}...`);
        try {
            const result = await deleteItem(id);
            console.log(`   ${result.success ? 'âœ…' : 'âŒ'} ID ${id}: ${result.status}`);
        } catch (e) {
            console.log(`   âŒ ID ${id}: ${e.message}`);
        }
        await new Promise(r => setTimeout(r, 300));
    }

    // Step 2: æ·»åŠ æ–°å†…å®¹
    console.log('\nğŸ“ Step 2: æ·»åŠ ç¼ºå¤±çš„ R1/F1 å†…å®¹...');
    for (const item of newContent) {
        console.log(`\n   å‘å¸ƒ [${item.freq}] ${item.author_name}...`);
        console.log(`   å­—æ•°: ${item.content.length}`);
        try {
            const result = await postItem(item);
            if (result.success) {
                console.log(`   âœ… å‘å¸ƒæˆåŠŸ`);
            } else {
                console.log(`   âŒ å¤±è´¥: ${result.status}`);
                console.log(`   ${result.body.substring(0, 100)}`);
            }
        } catch (e) {
            console.log(`   âŒ é”™è¯¯: ${e.message}`);
        }
        await new Promise(r => setTimeout(r, 300));
    }

    console.log('\n' + '='.repeat(60));
    console.log('âœ… ä¿®å¤å®Œæˆ');
    console.log('='.repeat(60));
}

main().catch(console.error);
